this is edited from com branch 