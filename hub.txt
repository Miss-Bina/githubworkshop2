this is edited from com branch 
changed from bina branch.